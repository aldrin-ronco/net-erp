<UserControl x:Class="NetErp.Inventory.MeasurementUnits.Views.MeasurementUnitView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:h="clr-namespace:NetErp.Helpers"
             xmlns:local="clr-namespace:NetErp.Inventory.MeasurementUnits.Views"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:busyIndicator="https://github.com/moh3ngolshani/BusyIndicator"
             xmlns:uc="clr-namespace:NetErp.UserControls"
             xmlns:dict="clr-namespace:Dictionaries;assembly=Dictionaries"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">

    <UserControl.Resources>
        <h:DictionaryLookupConverter x:Key="MeasurementUnitTypeConverter"
                                     Dictionary="{x:Static dict:InventoriesDictionaries.MeasurementUnitTypeDictionary}"/>
    </UserControl.Resources>

    <Border Background="White" BorderBrush="#D9DDE3" BorderThickness="1"
            CornerRadius="8" Margin="10">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Row 0: Search label -->
            <TextBlock Grid.Row="0" Text="¿Qué desea buscar?" Margin="20,15,20,5"/>

            <!-- Row 1: Search box -->
            <dxe:ButtonEdit
                Grid.Row="1"
                Margin="20,0,20,0"
                NullText="Escribe por lo menos 3 letras para iniciar la busqueda"
                ToolTip="Escribe aqui para buscar"
                MinHeight="25"
                CharacterCasing="Upper"
                BorderBrush="#C8CED6"
                AllowDefaultButton="False"
                h:FocusBehavior.IsFocused="True"
                Text="{Binding FilterSearch, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=500}">
                <dxe:ButtonEdit.Buttons>
                    <dxe:ButtonInfo IsLeft="True" GlyphKind="Search" Margin="4,0,2,0"/>
                </dxe:ButtonEdit.Buttons>
            </dxe:ButtonEdit>

            <!-- Row 2: Grid -->
            <busyIndicator:BusyMask x:Name="BusyIndicator"
                                    IsBusy="{Binding IsBusy}"
                                    IndicatorType="BouncingDot"
                                    BusyContent="Please wait..."
                                    BusyContentMargin="0,20,0,0"
                                    Grid.Row="2">

                <dxg:GridControl Margin="20,10,20,0"
                                 ItemsSource="{Binding Path=MeasurementUnits, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                 SelectedItem="{Binding Path=SelectedMeasurementUnit, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                    <dxg:GridControl.View>
                        <dxg:TableView AllowEditing="False"
                                       AllowCascadeUpdate="False"
                                       EnableSelectedRowAppearance="True"
                                       ShowGroupPanel="False" AlternateRowBackground="Beige"
                                       AllowColumnMoving="False"/>
                    </dxg:GridControl.View>

                    <dxg:GridColumn Header="Abreviación" HorizontalHeaderContentAlignment="Center" Width="Auto"
                                    Binding="{Binding Abbreviation}"/>
                    <dxg:GridColumn Header="Nombre" HorizontalHeaderContentAlignment="Center" Width="*"
                                    Binding="{Binding Name}"/>
                    <dxg:GridColumn Header="Tipo" HorizontalHeaderContentAlignment="Center" Width="Auto"
                                    Binding="{Binding Type, Converter={StaticResource MeasurementUnitTypeConverter}}"/>
                    <dxg:GridColumn Header="Código DIAN" HorizontalHeaderContentAlignment="Center" MinWidth="110"
                                    Binding="{Binding DianCode}"/>
                </dxg:GridControl>
            </busyIndicator:BusyMask>

            <!-- Row 3: Pagination -->
            <uc:GridPaging Grid.Row="3"
                           Margin="20,10,20,0"
                           HorizontalAlignment="Stretch"
                           VerticalAlignment="Center"
                           ChangedIndexCommand="{Binding PaginationCommand}"
                           PageIndex="{Binding PageIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           PageSize="{Binding PageSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           TotalCount="{Binding TotalCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           ResponseTime="{Binding ResponseTime, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Row 4: Action buttons centered -->
            <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,20">
                <!-- Nuevo -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding Path=IsBusy, Converter={dxmvvm:BooleanNegationConverter}}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding CreateMeasurementUnitCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Actions/New_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Nuevo" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <!-- Editar -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding CanEditMeasurementUnit}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding EditMeasurementUnitCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Edit/Edit_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Editar" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <!-- Eliminar -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding CanDeleteMeasurementUnit}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding DeleteMeasurementUnitCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Actions/DeleteList_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Eliminar" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
