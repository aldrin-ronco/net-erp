<UserControl x:Class="NetErp.Books.AccountingEntities.Views.AccountingEntityMasterView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:h="clr-namespace:NetErp.Helpers"
             xmlns:local="clr-namespace:NetErp.Books.AccountingEntities.ViewModels"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:busyIndicator="https://github.com/moh3ngolshani/BusyIndicator"
             xmlns:uc="clr-namespace:NetErp.UserControls"
             d:DataContext="{d:DesignInstance Type=local:AccountingEntityMasterViewModel}"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">

    <Border Background="White" BorderBrush="#D9DDE3" BorderThickness="1"
            CornerRadius="8" Margin="10">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Row 0: Search label -->
            <TextBlock Grid.Row="0" Text="¿Qué desea buscar?" Margin="20,15,20,5"/>

            <!-- Row 1: Search box -->
            <dxe:ButtonEdit
                Grid.Row="1"
                Margin="20,0,20,0"
                NullText="Escribe por lo menos 3 letras para iniciar la busqueda"
                ToolTip="Escribe aqui para buscar"
                MinHeight="25"
                CharacterCasing="Upper"
                BorderBrush="#C8CED6"
                AllowDefaultButton="False"
                h:FocusBehavior.IsFocused="True"
                Text="{Binding FilterSearch, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=500}">
                <dxe:ButtonEdit.Buttons>
                    <dxe:ButtonInfo IsLeft="True" GlyphKind="Search" Margin="4,0,2,0"/>
                </dxe:ButtonEdit.Buttons>
            </dxe:ButtonEdit>

            <!-- Row 2: Grid -->
            <busyIndicator:BusyMask x:Name="BusyIndicator"
                                    IsBusy="{Binding IsBusy}"
                                    IndicatorType="BouncingDot"
                                    BusyContent="Please wait..."
                                    BusyContentMargin="0,20,0,0"
                                    Grid.Row="2">

                <dxg:GridControl Margin="20,10,20,0"
                                 ItemsSource="{Binding Path=AccountingEntities, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 SelectedItem="{Binding Path=SelectedAccountingEntity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <dxg:GridControl.View>
                        <dxg:TableView AllowEditing="False"
                                       AllowCascadeUpdate="False"
                                       EnableSelectedRowAppearance="True"
                                       ShowGroupPanel="False" AlternateRowBackground="Beige"
                                       AllowColumnMoving="False"/>
                    </dxg:GridControl.View>

                    <dxg:GridColumn Header="NIT" HorizontalHeaderContentAlignment="Center" Width="Auto"
                                    Binding="{Binding IdentificationNumberWithVerificationDigit, Mode=OneWay}"/>
                    <dxg:GridColumn Header="Nombre del tercero" HorizontalHeaderContentAlignment="Center" Width="*"
                                    Binding="{Binding SearchName, Mode=OneWay}"/>
                    <dxg:GridColumn Header="Régimen" HorizontalHeaderContentAlignment="Center" Width="Auto" MinWidth="150"
                                    Binding="{Binding RegimeResolve, Mode=OneWay}"/>
                    <dxg:GridColumn Header="Dirección" HorizontalHeaderContentAlignment="Center" Width="*" MinWidth="200"
                                    Binding="{Binding Address, Mode=OneWay}"/>
                    <dxg:GridColumn Header="Información telefónica" HorizontalHeaderContentAlignment="Center" Width="Auto" MinWidth="200"
                                    Binding="{Binding TelephonicInformation, Mode=OneWay}"/>
                </dxg:GridControl>
            </busyIndicator:BusyMask>

            <!-- Row 3: Pagination -->
            <uc:GridPaging Grid.Row="3"
                           Margin="20,10,20,0"
                           HorizontalAlignment="Stretch"
                           VerticalAlignment="Center"
                           ChangedIndexCommand="{Binding PaginationCommand}"
                           PageIndex="{Binding PageIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           PageSize="{Binding PageSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           TotalCount="{Binding TotalCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           ResponseTime="{Binding ResponseTime, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Row 4: Action buttons centered -->
            <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,20">
                <!-- Nuevo -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding Path=IsBusy, Converter={dxmvvm:BooleanNegationConverter}}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding CreateAccountingEntityCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Actions/New_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Nuevo" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <!-- Editar -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding CanEditAccountingEntity}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding EditAccountingEntityCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Edit/Edit_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Editar" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <!-- Eliminar -->
                <Button Background="Transparent" BorderThickness="0" Padding="15,5" Cursor="Hand"
                        IsEnabled="{Binding CanDeleteAccountingEntity}">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding DeleteAccountingEntityCommand}" EventName="Click"/>
                    </dxmvvm:Interaction.Behaviors>
                    <StackPanel HorizontalAlignment="Center">
                        <Image Source="{dx:DXImage 'Images/Actions/DeleteList_32x32.png'}" Width="32" Height="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="Eliminar" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
